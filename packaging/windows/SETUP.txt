-----------------------
READY-MADE DEPENDENCIES
-----------------------

Install MSYS2:

  Download the 32-bit installer from https://msys2.github.io/
  Follow instructions on that page to update the core packages

Install basic utilities from MSYS2:

  pacman -S diffutils git man-db patch perl openssh tar unzip vim wget zip

  Edit ~/.bashrc to add the line:

    export PKG_CONFIG_PATH="$PKG_CONFIG_PATH":/home/bab/software/lib/pkgconfig

Install build dependencies from mingw-w64:

  pacman -S make libxslt
  pacman -S mingw-w64-i686-toolchain
  pacman -S mingw-w64-i686-boost
  pacman -S mingw-w64-i686-cmake
  pacman -S mingw-w64-i686-cppunit
  pacman -S mingw-w64-i686-doxygen
  pacman -S mingw-w64-i686-libxml2
  pacman -S mingw-w64-i686-popt

Install build dependencies with standalone installers:

  Qt5 (from qt-project.org)
  Graphviz (from graphviz.org)
  Wix (from wixtoolset.org)

------------------------
HAND-ROLLED DEPENDENCIES
------------------------

To build source-highlight (verified for v3.1.8):

  ./configure --prefix=/home/bab/software --with-boost-libdir=/mingw32/lib
  make ; make install

To build qdbm, which replaces tokyocabinet for MinGW (verified for v1.8.78):

  ./configure --prefix=/home/bab/software
  make ; make install

  (Note: tokyocabinet does not build because glob.h is missing.)

---------------
BUILDING REGINA
---------------

To build regina:

  Run cmake-regina.sh (in this directory) to get all necessary cmake arguments.

To run the test suite:

  export PATH="$PATH":/home/bab/software/bin
  make test ARGS=-V

To run locally:

  Copy all necessary DLLs into software/bin.

  - Most DLLs come from /mingw32/bin/, and perhaps /bin/.

  - Some DLLs come from graphviz.
      * From lib/release/dll/:
        gvc cdt cgraph Pathplan gvplugin_core gvplugin_neato_layout
      * From bin/:
        ltdl libexpat libglib-2.0-0

----------------------
BUILDING THE INSTALLER
----------------------

TODO: Revise this section - it dates back to the last release from 2014.

To build the python system library for shipping:

  cd /c/Python27/Lib
  zip -r path/to/python27.zip . -x distutils/\* -x \*.pyc
  Also copy python27.dll from /c/Windows/System32

To prepare WiX for use:
  If WiX is not on the path, add aliases to ~/.bashrc:
    alias candle='"/c/Program Files/WiX Toolset v3.7/bin/candle"'
    alias light='"/c/Program Files/WiX Toolset v3.7/bin/light"'

To generate unique IDs for the windows installer:
  Build UUIDgen (gcc UUIDgen.c -lole32 -o UUIDgen)

To help fill documentation entries in regina.wsx:
  ls -1 ~/foo/MinGW/msys/1.0/home/bab/software/share/regina/docs/en/regina |
    sed -e "s#^#                        <File Name='#"
        -e "s#\$#'/>#" 
    > /tmp/foo

To build the installer:
  candle Regina.wxs WixUI_Regina.wxs
  light -ext WixUIExtension -o 'Regina 4.96.msi' Regina.wixobj WixUI_Regina.wixobj

