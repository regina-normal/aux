Notes for building Debian-based packages
----------------------------------------

- To avoid automatic -dbgsym packages: DEB_BUILD_OPTIONS=noautodbgsym
- To skip the "make check": DEB_BUILD_OPTIONS=nocheck
- To finish a build without cleaning first: debuild -nc
- To build a source-only package (required for testing migration): debuild -S
- To build only architecture-dependent binary packages: debuild -B
- To force the .orig.tar.gz to be uploaded (not just the diff): debuild -sa

DEB_BUILD_OPTIONS should be space-separated.

To build in a clean chroot:

- Ensure the user (e.g., bab) is in sudoers:

    $ su
    # visudo

- Once only, as root:

    # pbuilder create --debootstrapopts --variant=buildd

- For each package build, as the user:

    $ pdebuild
    $ cd /var/cache/pbuilder/results
    ... and fetch the resulting build.


Setting up Parallels virtual machines
-------------------------------------

Configuration:
- Options / Sharing (nothing but Public/ and Drop Box/)
- Options / Applications (no sharing, just full-screen apps)

Installer notes:
- Debian installer: deselect print server
- Ubuntu: download x.y.0 release from http://old-releases.ubuntu.com/releases/
- Ubuntu installer: minimal install
- Ubuntu installer: disable "download updates while installing"

Disable updates:
- Debian in /etc/apt/sources.list
- Ubuntu via the Software app (-security only, not -updates)

Check for unwanted newer packages:
- Debian/Ubuntu:
  * apt-get install apt-show-versions
  * apt-show-versions | fgrep newer

Desktop tweaks:
- Put Terminal in sidebar
- Disable screen saver


---------
OLD NOTES
---------

To build binary packages only on debian sid from a .dsc:

    sbuild -d sid *.dsc

To build in a clean chroot:

- Install schroot
- If desired, edit /etc/schroot/mount-defaults for safer /home mounting,
  as described in ../chroots/0_init_schroot.txt
- Create /var/chroot
- Add schroot entries:

    [sid]
    type=directory
    description=Debian sid (unstable)
    directory=/var/chroot/sid
    users=bab
    root-users=root

- Create /var/chroot/sid/home/bab and chown to bab.bab
- If making an ubuntu chroot, add universe to <chroot>/etc/apt/sources.list
- Install the core distribution:

    sudo debootstrap --include=fakeroot --variant=buildd sid /var/chroot/sid

- Install build-depends:

    sudo schroot -c sid -- apt-get update
    sudo schroot -c sid -- apt-get install --no-install-recommends <build-deps>

- Install helper tools:

    sudo schroot -c sid -- apt-get install --no-install-recommends \
      devscripts lintian dput

- Enter the chroot and build.

