#!/bin/bash
set -e

# OSX icons:
rm -rf regina.iconset x-regina.iconset
mkdir regina.iconset x-regina.iconset
for i in 16 32 128 256 512; do
  size=$i
  rsvg -w$size -h$size regina.svg regina.iconset/icon_${size}x${size}.png
  rsvg -w$size -h$size x-regina.svg x-regina.iconset/icon_${size}x${size}.png
  size=$(($i + $i))
  rsvg -w$size -h$size regina.svg regina.iconset/icon_${i}x${i}@2x.png
  rsvg -w$size -h$size x-regina.svg x-regina.iconset/icon_${i}x${i}@2x.png
done
xcrun iconutil -c icns regina.iconset
xcrun iconutil -c icns x-regina.iconset
rm -rf regina.iconset x-regina.iconset

# MSWindows icons:
rm -f regina.ico x-regina.ico
rm -rf mswindows
mkdir mswindows
sizes="16 24 32 48 64 256"
for i in $sizes; do
  size=$i
  rsvg -w$size -h$size regina.svg mswindows/regina-${i}.png
  rsvg -w$size -h$size x-regina.svg mswindows/x-regina-${i}.png
done
for i in regina x-regina; do
  sources=
  for j in $sizes; do
    sources="$sources mswindows/$i-$j.png"
  done
  convert $sources $i.ico
done
rm -rf mswindows

# XDG icons:
rm -rf xdg
mkdir xdg
for i in 16 22 24 32 48 64 128 256; do
  size=$i
  rsvg -w$size -h$size regina.svg xdg/regina-${size}.png
  rsvg -w$size -h$size x-regina.svg xdg/x-regina-${size}.png
done

# QtUI icons:
rm -rf qtui
mkdir qtui
for i in 16 22 32 48 64; do
  size=$i
  rsvg -w$size -h$size regina.svg qtui/regina-${i}.png
  size=$(($i + $i))
  rsvg -w$size -h$size regina.svg qtui/regina-${i}@2x.png
done

# iOS document icons:
# - ReginaLarge: 310 (x1,2,3)
# - Packets/Document: 32 (x1,2,3)
# - RGA DocType: 64 320
rm -rf ios
mkdir ios
for i in 32 310; do
  size=$i
  rsvg -w$size -h$size regina.svg ios/regina-${i}.png
  size=$(($i+$i))
  rsvg -w$size -h$size regina.svg ios/regina-${i}@2x.png
  size=$(($i+$i+$i))
  rsvg -w$size -h$size regina.svg ios/regina-${i}@3x.png
done
for i in 64 320; do
  size=$i
  rsvg -w$size -h$size regina.svg ios/regina-doc-${size}.png
done

# iOS app icons (reversed):
# - App icon: 16 32 64 128 256 512 1024
# - Spotlight: 40 80
# - Settings: 29 58
# - iPad app: 76 152
# - iPhone app: 120 180

rm -rf app
mkdir app
for i in 16; do
  rsvg -w$i -h$i app-lores.svg app/app-$i.png
done

for i in 29 32 40 58 64 76 80 120 128 152 180 256 512 1024; do
  rsvg -w$i -h$i app.svg app/app-$i.png
done

convert -alpha off app/app-1024.png appstore.png

